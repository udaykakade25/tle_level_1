DMSL 2(A) 

--Create Table and Insert Records— 
create table emp(id int, name varchar(10), salary int, address varchar(30), age int, primary 
key(id));  
insert into emp(id,name,salary,address,age) values(1,'Amogh', 45000, 'Roha-Raigad', 19);  
insert into emp(id,name,salary,address,age) values(2,'Shreya', 42000, 'Mahad-Raigad', 19);  
insert into emp(id,name,salary,address,age) values(3,'Rohit', 43000, 'Alibaug-Raigad', 20);  
insert into emp(id,name,salary,address,age) values(4,'Atharva', 55000, 'Murud-Raigad', 19);  
insert into emp(id,name,salary,address,age) values(5,'Balaji', 45000, 'Mangaon-Raigad', 19); 
insert into emp(id,name,salary,address,age) values(6,'Jignesh', 46000, 'Panvel-Raigad', 20); --Update— 
update emp set salary=55000 where name='Balaji';  --Delete record— 
delete from emp where id=5; --Alter Table-- alter table emp add email varchar(15);  --Update Table— 
update emp set email='amogh@gmail.com' where id=1;  
update emp set email='shreya@gmail.com' where id=2;  
update emp set email='rohit@gmail.com' where id=3;  
update emp set email='atharva@gmail.com' where id=4;  
update emp set email='balaji@gmail.com' where id=5; 
update emp set email='jignesh@gmail.com' where id=6; 
--Queries with operators— 
select * from emp where id=1 and name='Amogh';and  
select * from emp where id=1 or id=5;or  
select * from emp where name like 'a%';  
select * from emp where name like 'r%t';  
select * from emp where salary between 42000 and 45000; between  
select * from emp where address in('Roha-Raigad','Alibaug-Raigad','Mangaon-Raigad');in  
select * from emp where address not in('Roha-Raigad','Alibaug-Raigad','Mangaon-Raigad');not in  --Views— 
create view emp_view as select id, name, address from emp;  
select * from emp_view;  --Indexes— 
create index emp_index on emp(id);  
select * from emp where id=1; --Sequences— 
create table emp1(id int not null auto_increment primary key, name varchar(100));  
insert into emp1(name) values('Amogh');  
insert into emp1(name) values('Shreya');  
select * from emp1;  
alter table emp1 set auto_increment=1; select * from emp1;  --Drop Table— drop table emp1; 


DMSL 2(B)


-- Creating Staff table  
CREATE TABLE Staff ( staff_id NUMBER(10), staff_name VARCHAR2(20), job_role 
VARCHAR2(20), dept_title VARCHAR2(25), city VARCHAR2(15), PRIMARY KEY(staff_name) ); --  
Inserting staff records with your names 
INSERT INTO Staff VALUES(201,'Saurabh','Accountant','Sales','Pune');  
INSERT INTO Staff VALUES(202,'Walmik','Associate','QualityControl','Solapur');  
INSERT INTO Staff VALUES(203,'Ameya','FinancialManager','Finance','Pune');  
INSERT INTO Staff VALUES(204,'Om','Manager','Production','Pune');  
INSERT INTO Staff VALUES(205,'Vinit','Analyst','CustomerCare','Mumbai');  
INSERT INTO Staff VALUES(206,'Sahil','Accountant','Payroll','Pune');  
INSERT INTO Staff VALUES(207,'Sarthak','Associate','HumanResources','Pune');  
INSERT INTO Staff VALUES(208,'Rutik','Analyst','Sales','Mumbai');  
INSERT INTO Staff VALUES(209,'Sohan','Accountant','Finance','Nashik');  
INSERT INTO Staff VALUES(210,'Yogesh','Associate','Production','Jalgaon');  -- Department table  
CREATE TABLE Dept ( dept_title VARCHAR2(25), head_name VARCHAR2(20), PRIMARY 
KEY(dept_title) );  -- Inserting departments  
INSERT INTO Dept VALUES('Sales','Yash');  
INSERT INTO Dept VALUES('QualityControl','Piyush');  
INSERT INTO Dept VALUES('Finance','Aditya');  
INSERT INTO Dept VALUES('Production','Safal');  
INSERT INTO Dept VALUES('CustomerCare','Anandrao');  
INSERT INTO Dept VALUES('HumanResources','Jay');  -- Salaries table  
CREATE TABLE Salaries ( staff_name VARCHAR2(20), dept_title VARCHAR2(25), salary 
NUMBER(8) NOT NULL, PRIMARY KEY(staff_name), FOREIGN KEY(dept_title) REFERENCES 
Dept(dept_title) );  -- Inserting salaries  
INSERT INTO Salaries VALUES('Saurabh','Sales',20000);  
INSERT INTO Salaries VALUES('Walmik','QualityControl',25000);  
INSERT INTO Salaries VALUES('Ameya','Finance',35000);  
INSERT INTO Salaries VALUES('Om','Production',50000);  
INSERT INTO Salaries VALUES('Vinit','CustomerCare',15000);  
INSERT INTO Salaries VALUES('Sahil','Payroll',17000);  
INSERT INTO Salaries VALUES('Sohan','Finance',30000);  -- Queries  
SELECT staff_name FROM Staff;  
SELECT staff_name FROM Salaries WHERE salary >= 30000;  
SELECT staff_name FROM Staff WHERE dept_title='Sales';  
SELECT staff_name FROM Staff WHERE city='Pune';  
SELECT * FROM Staff WHERE city='Pune';  
SELECT * FROM Staff WHERE city='Solapur';  
SELECT * FROM Staff WHERE city='Mumbai';  
SELECT staff_name FROM Staff WHERE staff_name LIKE 'S%';  
SELECT staff_name, MAX(salary) AS Highest_Salary FROM Salaries;  
SELECT staff_name, MIN(salary) AS Lowest_Salary FROM Salaries;  
SELECT * FROM Staff ORDER BY staff_name ASC;  
SELECT * FROM Staff ORDER BY staff_name DESC;  -- Inner Join  
SELECT D.dept_title, S.staff_name, S.salary FROM Dept D INNER JOIN Salaries S ON 
D.dept_title = S.dept_title WHERE D.head_name='Piyush'; -- Left Join  
SELECT D.dept_title, S.salary FROM Dept D LEFT OUTER JOIN Salaries S ON D.dept_title = 
S.dept_title;  -- Right Join  
SELECT D.dept_title, S.salary FROM Dept D RIGHT OUTER JOIN Salaries S ON D.dept_title = 
S.dept_title;  -- Full Join  
SELECT D.dept_title, S.salary FROM Dept D FULL OUTER JOIN Salaries S ON D.dept_title = 
S.dept_title;  -- Subquery  
SELECT staff_name, dept_title FROM Staff WHERE staff_name IN (SELECT staff_name FROM 
Staff WHERE city='Pune');  
-- Update with subquery  
UPDATE Dept SET head_name='Parth' WHERE dept_title IN (SELECT dept_title FROM Salaries 
WHERE staff_name='Vinit');  
SELECT * FROM Dept WHERE dept_title='CustomerCare';  -- Delete with subquery  
DELETE FROM Salaries WHERE staff_name IN (SELECT staff_name FROM Staff WHERE 
dept_title='Production');  
SELECT * FROM Salaries;  -- Exists  
SELECT dept_title FROM Dept WHERE EXISTS (SELECT staff_name FROM Staff WHERE 
city='Pune');  -- Join with condition  
SELECT st.staff_id, st.staff_name, sl.salary FROM Staff st, Salaries sl WHERE st.staff_name = 
sl.staff_name AND city='Pune';  -- Sorting by dept  
SELECT staff_name, dept_title FROM Staff ORDER BY dept_title DESC;  -- Distinct  
SELECT DISTINCT dept_title FROM Staff;  
-- Aggregates  
SELECT AVG(salary) FROM Salaries;  
SELECT COUNT(staff_name) FROM Staff WHERE city='Pune';  
SELECT SUM(salary) FROM Salaries WHERE dept_title='Finance';  
SELECT DISTINCT city FROM Staff;  -- Between  
SELECT staff_name, salary FROM Salaries WHERE salary BETWEEN 10000 AND 20000;  -- Exists with subquery  
SELECT staff_name FROM Staff WHERE EXISTS (SELECT salary FROM Salaries WHERE 
Staff.staff_name=Salaries.staff_name AND salary>=20000); 
DMSL 3 --INNER JOIN-- 
SELECT s.student_id, s.name AS student_name, d.dept_name FROM Students s 
INNER JOIN Departments d ON s.dept_id = d.dept_id; --LEFT JOIN-- 
SELECT s.student_id, s.name, e.course_id 
FROM Students s 
LEFT JOIN Enrollments e ON s.student_id = e.student_id 
ORDER BY s.student_id; --RIGHT JOIN-- 
SELECT e.enroll_id, e.student_id, c.course_name 
FROM Enrollments e 
RIGHT JOIN Courses c ON e.course_id = c.course_id; --FULL OUTER JOIN-- 
SELECT s.student_id, s.name, e.course_id 
FROM Students s FULL OUTER JOIN Enrollments e ON s.student_id = e.student_id; --CROSS JOIN-- 
SELECT s.name AS student_name, c.course_name 
FROM Students s 
CROSS JOIN Courses c; 
--SELF JOIN-- 
SELECT s1.student_id AS s1_id, s1.name AS s1_name, 
s2.student_id AS s2_id, s2.name AS s2_name 
FROM Students s1 
JOIN Students s2 ON s1.dept_id = s2.dept_id 
WHERE s1.student_id < s2.student_id; --Subquery in WHERE — Students in 'Computer Science' department-- 
SELECT name FROM Students 
WHERE dept_id = ( 
SELECT dept_id FROM Departments WHERE dept_name = 'Computer Science' 
); --Subquery with IN — Students enrolled in a particular course (by name)-- 
SELECT s.name 
FROM Students s 
WHERE s.student_id IN ( 
SELECT e.student_id 
FROM Enrollments e 
JOIN Courses c ON e.course_id = c.course_id 
WHERE c.course_name = 'Database Systems' 
); 
--Correlated Subquery — Students with more than 3 courses-- 
SELECT s.name 
FROM Students s 
WHERE ( 
SELECT COUNT(*) 
FROM Enrollments e WHERE e.student_id = s.student_id ) > 3; --Subquery in FROM (Derived Table) — Count students per department (age > 18)-- 
SELECT dt.dept_id, d.dept_name, dt.total_students 
FROM ( 
SELECT dept_id, COUNT(*) AS total_students 
FROM Students 
WHERE age > 18 
GROUP BY dept_id 
) AS dt 
JOIN Departments d ON dt.dept_id = d.dept_id; --Subquery in SELECT — Student name with number of courses taken-- 
SELECT s.student_id, s.name, 
(SELECT COUNT(*) FROM Enrollments e WHERE e.student_id = s.student_id) AS total_courses 
FROM Students s; --CREATE VIEW — StudentCourseDetails and using it-- 
CREATE VIEW StudentCourseDetails AS 
SELECT s.student_id, s.name AS student_name, c.course_id, c.course_name, e.grade 
FROM Students s 
JOIN Enrollments e ON s.student_id = e.student_id 
JOIN Courses c ON e.course_id = c.course_id; -- Using the view 
SELECT * FROM StudentCourseDetails WHERE grade >= 'B'; 


DMSL 4-5 



PL/SQL Code : -- Enable DBMS output 
set serveroutput on; 
 -- Create tables 
create table Borrower ( 
    Roll_no number, 
    Name varchar2(15), 
    Date_of_Issue date, 
    Name_of_Book varchar2(20), 
    Status char(1) 
); 
 
create table Fine ( 
    Roll_no number, 
    Date_ date, 
    Amt number 
); 
 -- Insert data 
insert into Borrower values(1, 'Alice', to_date('2025-07-01','yyyy-mm-dd'), 'PL/SQL Programming', 
'I'); 
insert into Borrower values(2, 'Bob', to_date('2025-06-15','yyyy-mm-dd'), 'Oracle Basics', 'I'); 
commit; 
 -- PL/SQL block 
declare 
    v_roll_no number := 1; 
    v_book_name varchar2(100) := 'PL/SQL Programming'; 
     
    v_issue_date date; 
    v_days number; 
    v_fine number := 0; 
    v_status char(1); 
begin 
    select Date_of_Issue, Status 
    into v_issue_date, v_status 
    from Borrower 
    where Roll_no = v_roll_no and Name_of_Book = v_book_name; 
     
    if v_status = 'R' then 
        dbms_output.put_line('Book already returned!'); 
    else 
        v_days := trunc(sysdate - v_issue_date); 
         
        if v_days > 30 then 
            v_fine := (30 - 15) * 5 + (v_days - 30) * 50; 
        elsif v_days > 15 then 
            v_fine := (v_days - 15) * 5; 
        else 
            v_fine := 0; 
        end if; 
         
        update Borrower 
        set Status = 'R' 
        where Roll_no = v_roll_no and Name_of_Book = v_book_name; 
         
        if v_fine > 0 then 
            insert into Fine(Roll_no, Date_, Amt) values(v_roll_no, sysdate, v_fine); 
        end if; 
         
        dbms_output.put_line('Book returned successfully!'); 
        dbms_output.put_line('Fine amount: Rs. ' || v_fine); 
    end if; 
 
exception 
    when no_data_found then 
        dbms_output.put_line('No record found for the given Roll no and Book Name.'); 
    when others then 
        dbms_output.put_line('Unexpected error: ' || SQLERRM); 
end; 
/ 
 
Output :  
SQL> @/home/comp-pj-23/Desktop/Practical4.sql 
 
Book returned successfully! 
Fine amount: Rs. 2175 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
DMSL 6 
 
SQL Code : 
create table Stud_Marks ( 
    name varchar2(50), 
    total_marks number 
); 
 
create table Result ( 
    roll number, 
    name varchar2(50), 
    class varchar2(30) 
); 
 
insert into Stud_Marks values ('Rohit', 1000); 
insert into Stud_Marks values ('Rohan', 950); 
insert into Stud_Marks values ('Amogh', 850); 
insert into Stud_Marks values ('Sachin', 800); 
commit; 
 
PL/SQL Code : 
create or replace procedure proc_Grade ( 
    p_marks in number, 
    p_class out varchar2 
) as 
begin 
    if p_marks <= 1500 and p_marks >= 990 then 
        p_class := 'Distinction'; 
    elsif p_marks between 900 and 989 then 
        p_class := 'First Class'; 
    elsif p_marks between 825 and 899 then 
        p_class := 'Higher Second Class'; 
    else 
        p_class := 'No Category'; 
    end if; 
end proc_Grade; 
/ 
 
declare 
    v_class varchar2(30); 
    v_roll number := 1; 
begin 
    for rec in (select name, total_marks from Stud_Marks) loop 
        -- call procedure 
        proc_Grade(rec.total_marks, v_class); 
 
        -- display student name, marks and category 
        dbms_output.put_line('Name: ' || rec.name || ', Marks: ' || 
                             rec.total_marks || ', Category: ' || v_class); 
 
        -- insert into result table 
        insert into Result (Roll, Name, Class) 
        values (v_roll, rec.name, v_class); 
 
        v_roll := v_roll + 1; 
    end loop; 
    commit; 
end; 
/ 
 
 
Output : 
SQL> @/home/comp-pj-42/Desktop/Practical5.sql 
Procedure created. 
Name:Rohit,Marks:1000,Category:Distinction 
Name:Rohan,Marks:950,Category:First Class 
Name:Amogh,Marks:850,Category:Higher Second Class 
Name:Sachin,Marks:800,Category:Higher Second Class 
PL/SQL procedure successfully completed. 
SQL>>  select * from result; 
ROLL   NAME   
CLASS ----------   -------------------------  ------------------------------------ 
1 Rohit                  
2 Rohan  
3 Amogh  
4 Sachin  
Distinction 
First Class 
Higher Second Class 
Higher Second Class 
DMSL 7 -- Enable DBMS output 
SET SERVEROUTPUT ON; 
Step 1: Create Original Table O_RollCall 
CREATE TABLE O_RollCall ( 
roll_no NUMBER(2), 
name VARCHAR2(25), 
age NUMBER(2), 
marks NUMBER(3) 
); -- Insert sample data into O_RollCall 
INSERT INTO O_RollCall VALUES (1, 'Rohan', 20, 91); 
INSERT INTO O_RollCall VALUES (2, 'Sneha', 21, 87); 
INSERT INTO O_RollCall VALUES (3, 'Kartik', 19, 95); 
INSERT INTO O_RollCall VALUES (4, 'Isha', 20, 89); 
Step 2: Create New Table N_RollCall 
CREATE TABLE N_RollCall ( 
roll_no NUMBER(2), 
name VARCHAR2(25), 
age NUMBER(2), 
marks NUMBER(3) 
); -- Insert some initial rows into N_RollCall 
INSERT INTO N_RollCall VALUES (1, 'Rohan', 20, 91); 
INSERT INTO N_RollCall VALUES (5, 'Anaya', 20, 93); 
INSERT INTO N_RollCall VALUES (6, 'Aditya', 21, 85); -- Commit the inserts 
COMMIT; 
Step 3: PL/SQL Block to Copy Missing Rows (Implicit Cursor) 
DECLARE 
a O_RollCall%ROWTYPE; 
BEGIN 
FOR a IN ( 
SELECT roll_no, name, age, marks 
FROM O_RollCall 
WHERE roll_no NOT IN (SELECT roll_no FROM N_RollCall) 
) 
LOOP 
INSERT INTO N_RollCall VALUES(a.roll_no, a.name, a.age, a.marks); 
END LOOP; 
DBMS_OUTPUT.PUT_LINE('Values copied'); 
END; 
/ 
Step 4: Check the Final Tables -- Original Table 
SELECT * FROM O_RollCall; -- New Table after copying missing rows 
SELECT * FROM N_RollCall; 
SQL> DECLARE ... 
SQL> / 
Values copied 
PL/SQL procedure successfully completed. 
SQL> SELECT * FROM O_RollCall; 
SQL> SELECT * FROM N_RollCall; 
DMSL 8 
Trigger before insert 
create table table1(rollno int, name varchar(10), nameofbook varchar(20)); 
create table table2(rollno int, name varchar(10), nameofbook varchar(20)); --insert into table1(rollno,name,nameofbook) values(1,'Amogh','Donovun'); --select * from table1; 
CREATE OR REPLACE TRIGGER tr_insert_Borrower 
BEFORE INSERT ON table1 
FOR EACH ROW 
BEGIN 
INSERT INTO table2 (rollno, name, nameofbook) VALUES (:NEW.rollno, :NEW.name, 
:NEW.nameofbook); 
END; 
/ 
insert into table1(rollno,name,nameofbook) values(2,'Omkar','Atomic Habits'); 
insert into table1(rollno,name,nameofbook) values(1,'Amogh','Donovun'); 
insert into table1(rollno,name,nameofbook) values(3,'Rohit','Donovun'); 
select * from table2; 
O/P- 
ROLLNO NAME NAMEOFBOOK ---------- ---------- -------------------- 
2 Omkar Atomic Habits 
1 Amogh Donovun 
3 Rohit Donovun 
ROLLNO NAME NAMEOFBOOK 
---------- ---------- -------------------- 
2 Omkar Atomic Habits 
1 Amogh Donovun 
3 Rohit Donovun 
Trigger before delete 
create table table1(rollno int, name varchar(10), nameofbook varchar(20)); 
create table table2(rollno int, name varchar(10), nameofbook varchar(20)); 
insert into table1(rollno,name,nameofbook) values(1,'Amogh','Donovun'); 
insert into table1(rollno,name,nameofbook) values(2,'Satav','Book2'); 
select * from table1; 
CREATE OR REPLACE TRIGGER tr_delete_Borrower 
BEFORE DELETE ON table1 
FOR EACH ROW 
BEGIN 
delete from table2 where rollno=:old.rollno; 
END; 
/ 
delete from table1 where rollno=1; 
select * from table2; 
O/P- 
ROLLNO NAME NAMEOFBOOK ---------- ---------- -------------------- 
1 Amogh Donovun 
2 Satav Book2 
Trigger before update 
create table table1(rollno int, name varchar(10), nameofbook varchar(20)); 
create table table2(rollno int, name varchar(10), nameofbook varchar(20)); 
insert into table1(rollno,name,nameofbook) values(1,'Amogh','Donovun'); 
insert into table1(rollno,name,nameofbook) values(2,'Satav','Book2'); 
select * from table1; 
CREATE OR REPLACE TRIGGER tr_up1_borrower 
BEFORE UPDATE ON table1 
FOR EACH ROW 
BEGIN 
UPDATE table2 
SET rollno = :NEW.rollno 
WHERE rollno = :OLD.rollno; 
END; 
/ 
UPDATE table1 SET rollno = 4 WHERE rollno = 2; 
SELECT * FROM table1; 
SELECT * FROM table2; 
O/P- 
ROLLNO NAME NAMEOFBOOK ---------- ---------- -------------------- 
1 Amogh Donovun 
2 Satav Book2 
ROLLNO NAME NAMEOFBOOK 
---------- ---------- -------------------- 
1 Amogh Donovun 
4 Satav Book2 
Trigger after insert 
create table table1( 
rollno int, 
name varchar2(10), 
nameofbook varchar2(20) 
); 
create table table2( 
rollno int, 
name varchar2(10), 
nameofbook varchar2(20) 
); 
create or replace trigger tr_after_insert_borrower 
after insert on table1 
for each row 
begin 
insert into table2 (rollno, name, nameofbook) 
values (:new.rollno, :new.name, :new.nameofbook); 
end; 
/ 
insert into table1 (rollno, name, nameofbook) 
values (1, 'amogh', 'donovun'); 
insert into table1 (rollno, name, nameofbook) 
values (2, 'satav', 'atomic habits'); 
select * from table1; 
select * from table2; 
O/P- 
ROLLNO NAME NAMEOFBOOK ---------- ---------- -------------------- 
1 amogh donovun 
2 satav atomic habits 
ROLLNO NAME NAMEOFBOOK ---------- ---------- -------------------- 
1 amogh donovun 
2 satav atomic habits 
Trigger after delete: 
create table table1( 
rollno int, 
name varchar2(10), 
nameofbook varchar2(20) 
); 
create table table2( 
rollno int, 
name varchar2(10), 
nameofbook varchar2(20) 
); 
create or replace trigger tr_after_delete_borrower 
after delete on table1 
for each row 
begin 
delete from table2 
where rollno = :old.rollno; 
end; 
/ 
insert into table1 (rollno, name, nameofbook) 
values (1, 'amogh', 'donovun'); 
insert into table1 (rollno, name, nameofbook) 
values (2, 'satav', 'atomic habits'); 
select * from table1; 
select * from table2; 
delete from table1 where rollno = 1; 
select * from table1; 
select * from table2; 
select * from table1; 
select * from table2; 
O/P- 
ROLLNO NAME NAMEOFBOOK ---------- ---------- -------------------- 
1 amogh donovun 
2 satav atomic habits 
ROLLNO NAME NAMEOFBOOK 
---------- ---------- -------------------- 
2 satav atomic habits 
ROLLNO NAME NAMEOFBOOK ---------- ---------- -------------------- 
2 satav atomic habits 
Trigger after update 
create table table1( 
rollno int, 
name varchar2(10), 
nameofbook varchar2(20) 
); 
create table table2( 
rollno int, 
name varchar2(10), 
nameofbook varchar2(20) 
); 
create or replace trigger tr_after_update_borrower 
after update on table1 
for each row 
begin 
update table2 
set rollno = :new.rollno, 
name = :new.name, 
nameofbook = :new.nameofbook 
where rollno = :old.rollno; 
end; 
/ 
insert into table1 (rollno, name, nameofbook) 
values (1, 'amogh', 'donovun'); 
insert into table1 (rollno, name, nameofbook) 
values (2, 'satav', 'atomic habits'); 
select * from table1; 
select * from table2; 
update table1 set rollno = 3, nameofbook = 'book3' where rollno = 2; 
select * from table1; 
select * from table2; 
O/P- 
ROLLNO NAME NAMEOFBOOK ---------- ---------- -------------------- 
1 amogh donovun 
2 satav atomic habits 
ROLLNO NAME NAMEOFBOOK ---------- ---------- -------------------- 
1 amogh donovun 
3 satav book3 
DMSL 10 MongoDB CRUD 
MongoDB Shell : 
C:\Users\athar>mongosh "mongodb+srv://cluster0.uihrcgx.mongodb.net/" --apiVersion 1 -
username amogh 
Enter password: ***** 
Current Mongosh Log ID: 68e9e90284347be50dcebea3 
Connecting to:          
mongodb+srv://<credentials>@cluster0.uihrcgx.mongodb.net/?appName=mongosh+2.5.8 
Using MongoDB:          
Using Mongosh:          
8.0.14 (API Version 1) 
2.5.8 
For mongosh info see: https://www.mongodb.com/docs/mongodb-shell/ 
Atlas atlas-c82fsq-shard-0 [primary] test> use EmployeeDB 
switched to db EmployeeDB 
Atlas atlas-c82fsq-shard-0 [primary] EmployeeDB> db.createCollection('Employee'); 
{ ok: 1 } 
...   { Emp_id: "E1001", Emp_Name: "John", Emp_salary: 60000, Emp_Dept: "HR" }, 
...   { Emp_id: "E1002", Emp_Name: "Smith", Emp_salary: 45000, Emp_Dept: "Marketing" }, 
...   { Emp_id: "E1003", Emp_Name: "Emily", Emp_salary: 55000, Emp_Dept: "IT" }, 
...   { Emp_id: "E1004", Emp_Name: "Jake", Emp_salary: 40000, Emp_Dept: "Marketing" }, 
...   { Emp_id: "E1005", Emp_Name: "Anna", Emp_salary: 75000, Emp_Dept: "Finance" }, 
...   { Emp_id: "E1006", Emp_Name: "Bob", Emp_salary: 35000, Emp_Dept: "IT" }, 
...   { Emp_id: "E1007", Emp_Name: "Charlie", Emp_salary: 70000, Emp_Dept: "HR" }, 
...   { Emp_id: "E1008", Emp_Name: "David", Emp_salary: 80000, Emp_Dept: "Finance" }, 
...   { Emp_id: "E1009", Emp_Name: "Lisa", Emp_salary: 30000, Emp_Dept: "Marketing" }, 
...   { Emp_id: "E1010", Emp_Name: "Tom", Emp_salary: 65000, Emp_Dept: "IT" } 
... ]); 
{ 
  acknowledged: true, 
  insertedIds: { 
    '0': ObjectId('68e9e99484347be50dcebea4'), 
    '1': ObjectId('68e9e99484347be50dcebea5'), 
    '2': ObjectId('68e9e99484347be50dcebea6'), 
    '3': ObjectId('68e9e99484347be50dcebea7'), 
    '4': ObjectId('68e9e99484347be50dcebea8'), 
    '5': ObjectId('68e9e99484347be50dcebea9'), 
    '6': ObjectId('68e9e99484347be50dcebeaa'), 
    '7': ObjectId('68e9e99484347be50dcebeab'), 
    '8': ObjectId('68e9e99484347be50dcebeac'), 
    '9': ObjectId('68e9e99484347be50dcebead') 
  } 
} 
Atlas atlas-c82fsq-shard-0 [primary] EmployeeDB> db.Employee.find({Emp_salary : {$gt: 
50000}}) 
[ 
  { 
    _id: ObjectId('68e9e99484347be50dcebea4'), 
    Emp_id: 'E1001', 
    Emp_Name: 'John', 
    Emp_salary: 60000, 
    Emp_Dept: 'HR' 
  }, 
  { 
    _id: ObjectId('68e9e99484347be50dcebea6'), 
    Emp_id: 'E1003', 
    Emp_Name: 'Emily', 
    Emp_salary: 55000, 
    Emp_Dept: 'IT' 
  }, 
  { 
    _id: ObjectId('68e9e99484347be50dcebea8'), 
    Emp_id: 'E1005', 
    Emp_Name: 'Anna', 
    Emp_salary: 75000, 
    Emp_Dept: 'Finance' 
  }, 
  { 
    _id: ObjectId('68e9e99484347be50dcebeaa'), 
    Emp_id: 'E1007', 
    Emp_Name: 'Charlie', 
    Emp_salary: 70000, 
    Emp_Dept: 'HR' 
  }, 
  { 
    _id: ObjectId('68e9e99484347be50dcebeab'), 
    Emp_id: 'E1008', 
    Emp_Name: 'David', 
    Emp_salary: 80000, 
    Emp_Dept: 'Finance' 
  }, 
  { 
    _id: ObjectId('68e9e99484347be50dcebead'), 
    Emp_id: 'E1010', 
    Emp_Name: 'Tom', 
    Emp_salary: 65000, 
    Emp_Dept: 'IT' 
  } 
] 
 
Atlas atlas-c82fsq-shard-0 [primary] EmployeeDB> 
db.Employee.updateOne({Emp_name:"Smith"},{$inc:{Emp_salary:5000}}); 
{ 
  acknowledged: true, 
  insertedId: null, 
  matchedCount: 0, 
  modifiedCount: 0, 
  upsertedCount: 0 
} 
 
Atlas atlas-c82fsq-shard-0 [primary] EmployeeDB> db.Employee.find({Emp_Dept: 
"Marketing",Emp_salary:{$lt:45000}}); 
[ 
  { 
    _id: ObjectId('68e9e99484347be50dcebea7'), 
    Emp_id: 'E1004', 
    Emp_Name: 'Jake', 
    Emp_salary: 40000, 
    Emp_Dept: 'Marketing' 
  }, 
  { 
    _id: ObjectId('68e9e99484347be50dcebeac'), 
    Emp_id: 'E1009', 
    Emp_Name: 'Lisa', 
    Emp_salary: 30000, 
    Emp_Dept: 'Marketing' 
  } 
] 
 
Atlas atlas-c82fsq-shard-0 [primary] EmployeeDB> db.Employee.find().sort({Emp_salary:
1}).limit(5); 
[ { 
  { _id: ObjectId('68e9e99484347be50dcebeab'), 
    _id: ObjectId('68e9e99484347be50dcebeab'), 
    Emp_id: 'E1008',', 
    Emp_Name: 'David', 
    Emp_salary: 80000,' 
    Emp_Dept: 'Finance' 
  }, 
  { _id: ObjectId('68e9e99484347be50dcebead'), 
    _id: ObjectId('68e9e99484347be50dcebea8'), 
    Emp_id: 'E1005', 
    Emp_Name: 'Anna',, 
    Emp_salary: 75000, 
    Emp_Dept: 'Finance' 
  }, 
  {as atlas-c82fsq-shard-0 [primary] EmployeeDB> 
    _id: ObjectId('68e9e99484347be50dcebeaa'), 
    Emp_id: 'E1007', 
    Emp_Name: 'Charlie', 
    Emp_salary: 70000, 
    Emp_Dept: 'HR' 
  }, 
  { 
    _id: ObjectId('68e9e99484347be50dcebead'), 
    Emp_id: 'E1010', 
    Emp_Name: 'Tom', 
    Emp_salary: 65000, 
    Emp_Dept: 'IT' 
  }, 
{ 
_id: ObjectId('68e9e99484347be50dcebea4'), 
Emp_id: 'E1001', 
Emp_Name: 'John', 
Emp_salary: 60000, 
Emp_Dept: 'HR' 
}] 
Atlas atlas-c82fsq-shard-0 [primary] EmployeeDB> db.Employee.deleteOne({Emp_id: 
"E1007"}); 
{ acknowledged: true, deletedCount: 1 } 
Atlas atlas-c82fsq-shard-0 [primary] EmployeeDB> db.Employee.createIndex({Emp_id:1}); 
Emp_id_1 
//Compare the time required to search Emp_id = E10008 before and after creating an index 
//before 
var start = new Date(); 
db.Employee.find({ Emp_id: &quot;E10008&quot; }).toArray(); 
var end = new Date(); 
print(&quot;Time taken before creating index: &quot; + (end - start) + &quot; ms&quot;); 
//after index creation 
var start = new Date(); 
db.Employee.find({ Emp_id: &quot;E10008&quot; }).toArray(); 
var end = new Date(); 
print(&quot;Time taken after creating index: &quot; + (end - start) + &quot; ms&quot;); 
//Adding at least 10,000 Documents to observe the effect of the index on performance 
// Inserting 10,000 documents for testing purposes 
for (let i = 0; i &lt; 10000; i++) { 
db.Employee.insertOne({ 
Emp_id: &quot;E&quot; + (i + 1010), 
Emp_Name: &quot;Employee&quot; + (i + 1010), 
Emp_salary: Math.floor(Math.random() * 50000) + 20000, // Random salary between 
20,000 to 70,000 
Emp_Dept: i % 2 == 0 ? &quot;HR&quot; : &quot;IT&quot; 
}); 
} 
DMSL 11 Aggregation 
C:\Users\athar>mongosh "mongodb+srv://cluster0.uihrcgx.mongodb.net/" --apiVersion 1 -
username amogh 
Enter password: ***** 
Current Mongosh Log ID: 68f0eed401c6005ffbcebea3 
Connecting to:          
mongodb+srv://<credentials>@cluster0.uihrcgx.mongodb.net/?appName=mongosh+2.5.8 
//create collection 
db.createCollection('Student'); 
{ ok: 1 } 
//insert many 
db.Student.insertMany([ {Roll_No:1, name:"Alice", class:"TE Comp A", sports:["Football", 
"Basketball"]}, {Roll_No:2, name:"Bob", class:"TE Comp B", sports:["Cricket"]}, {Roll_No:3, 
name:"Charlie", class:"TE Comp C", sports:["Football"]}, {Roll_No:4, name:"David", class:"TE 
Comp A", sports:["Basketball"]}, {Roll_No:5, name:"Evan", class:"TE Comp B", 
sports:["Football"]}]); 
{ 
acknowledged: true, 
insertedIds: { 
'0': ObjectId('68f0f1ea01c6005ffbcebea4'), 
'1': ObjectId('68f0f1ea01c6005ffbcebea5'), 
'2': ObjectId('68f0f1ea01c6005ffbcebea6'), 
'3': ObjectId('68f0f1ea01c6005ffbcebea7'), 
'4': ObjectId('68f0f1ea01c6005ffbcebea8') 
} 
} 
//update 
db.Student.updateOne({Roll_No:1},{$set:{marks:85} 
... }); 
{ 
acknowledged: true, 
insertedId: null, 
matchedCount: 1, 
modifiedCount: 1, 
upsertedCount: 0 
}…… 
//index 
db.Student.createIndex({name:1}); 
name_1 
//first 5 max marks students 
db.Student.find().sort({marks:-1}).limit(5); 
[ 
{ 
_id: ObjectId('68f0f6cd01c6005ffbcebea9'), 
Roll_No: 6, 
name: 'Fallu', 
class: 'TE Comp A', 
    sports: [ 'Baseball', 'Cricket' ], 
    marks: 95 
  }, 
  { 
    _id: ObjectId('68f0f1ea01c6005ffbcebea8'), 
    Roll_No: 5, 
    name: 'Evan', 
    class: 'TE Comp B', 
    sports: [ 'Football' ], 
    marks: 90 
  }, 
  { 
    _id: ObjectId('68f0f1ea01c6005ffbcebea5'), 
    Roll_No: 2, 
    name: 'Bob', 
    class: 'TE Comp B', 
    sports: [ 'Cricket' ], 
    marks: 90 
  }, 
  { 
    _id: ObjectId('68f0f1ea01c6005ffbcebea4'), 
    Roll_No: 1, 
    name: 'Alice', 
    class: 'TE Comp A', 
    sports: [ 'Football', 'Basketball' ], 
marks: 85 
}, 
{ 
} 
] 
_id: ObjectId('68f0f1ea01c6005ffbcebea7'), 
Roll_No: 4, 
name: 'David', 
class: 'TE Comp A', 
sports: [ 'Basketball' ], 
marks: 75 
//max marks of all classes 
db.Student.aggregate([ {$group:{_id:"$class", maxMarks:{$max:"$marks"}}}]); 
[ 
] 
{ _id: 'TE Comp C', maxMarks: 70 }, 
{ _id: 'TE Comp B', maxMarks: 90 }, 
{ _id: 'TE Comp A', maxMarks: 95 } 
//avg marks of all classes 
db.Student.aggregate([ {$group:{_id:"$class", maxMarks:{$avg:"$marks"}}}]); 
[ 
{ _id: 'TE Comp A', maxMarks: 85 }, 
{ _id: 'TE Comp B', maxMarks: 81.66666666666667 }, 
{ _id: 'TE Comp C', maxMarks: 55 } 
] 
//find roll nos. of TE Comp A 
> db.Student.find({class:"TE Comp A"},{Roll_No:true,_id:false}); 
[ { Roll_No: 1 }, { Roll_No: 4 }, { Roll_No: 6 } ] 
// Student of class C who are fail 
db.Student.find({class:"TE Comp C",marks:{$lt:50}},{_id:false}); 
[ 
] 
{ 
} 
Roll_No: 3, 
name: 'Charlie', 
class: 'TE Comp C', 
sports: [ 'Football' ], 
marks: 40 
//display all 
db.Student.find({},{Roll_No:true,class:true,name:true,marks:true,sports:true,_id:false}); 
[ 
{ 
Roll_No: 1, 
name: 'Alice', 
    class: 'TE Comp A', 
    sports: [ 'Football', 'Basketball' ], 
    marks: 85 
  }, 
  { 
    Roll_No: 2, 
    name: 'Bob', 
    class: 'TE Comp B', 
    sports: [ 'Cricket' ], 
    marks: 90 
  }, 
  { 
    Roll_No: 3, 
    name: 'Charlie', 
    class: 'TE Comp C', 
    sports: [ 'Football' ], 
    marks: 40 
  }, 
  { 
    Roll_No: 4, 
    name: 'David', 
    class: 'TE Comp A', 
    sports: [ 'Basketball' ], 
    marks: 75 
  }, 
  { 
    Roll_No: 5, 
    name: 'Evan', 
    class: 'TE Comp B', 
    sports: [ 'Football' ], 
    marks: 90 
  }, 
  { 
    Roll_No: 6, 
    name: 'Fallu', 
    class: 'TE Comp A', 
    sports: [ 'Baseball', 'Cricket' ], 
    marks: 95 
  }, 
  { 
    Roll_No: 7, 
    name: 'Giggle', 
    class: 'TE Comp C', 
    marks: 70, 
    sports: [ 'Football' ] 
  }, 
  { 
    Roll_No: 8, 
    name: 'Harsh', 
    class: 'TE Comp B', 
    marks: 65, 
    sports: [ 'Chess' ] 
  } 
] 
 
//students who play football 
db.Student.find({sports:"Football"},{_id:false}); 
[ 
  { 
    Roll_No: 1, 
    name: 'Alice', 
    class: 'TE Comp A', 
    sports: [ 'Football', 'Basketball' ], 
    marks: 85 
  }, 
  { 
    Roll_No: 3, 
    name: 'Charlie', 
    class: 'TE Comp C', 
    sports: [ 'Football' ], 
    marks: 40 
  }, 
  { 
    Roll_No: 5, 
    name: 'Evan', 
    class: 'TE Comp B', 
    sports: [ 'Football' ], 
    marks: 90 
  }, 
  { 
    Roll_No: 7, 
    name: 'Giggle', 
    class: 'TE Comp C', 
    marks: 70, 
    sports: [ 'Football' ] 
  } 
] 
 
 
 
 
 
 
 
 
 
 
 
 
 
DMSL 9 MySQL DB Connectivity 
import mysql.connector 
from tkinter import * 
# --- Database Connection --- 
conn = mysql.connector.connect( 
host="localhost", 
user="root", 
password="", 
database="students_db" 
) 
cursor = conn.cursor() 
cursor.execute("SELECT * FROM student") 
records = cursor.fetchall() 
# --- Tkinter Window --- 
root = Tk() 
root.title("MySQL Database Navigation") 
index = 0 
# --- Labels --- 
id_label = Label(root, text="") 
name_label = Label(root, text="") 
id_label.pack(pady=5) 
name_label.pack(pady=5) 
# --- Functions --- 
def show_record(i): 
id_label.config(text=f"ID: {records[i][0]}") 
name_label.config(text=f"Name: {records[i][1]}") 
def next_record(): 
global index 
if index < len(records) - 1: 
index += 1 
show_record(index) 
def prev_record(): 
global index 
if index > 0: 
index -= 1 
show_record(index) 
# --- Buttons --- 
Button(root, text="<< Prev", command=prev_record).pack(side=LEFT, padx=10) 
Button(root, text="Next >>", command=next_record).pack(side=RIGHT, padx=10) 
# --- Show First Record --- 
show_record(index) 
root.mainloop() 
MySQL: 
CREATE DATABASE students_db; 
USE students_db; 
CREATE TABLE student ( 
id INT PRIMARY KEY, 
name VARCHAR(50) 
); 
INSERT INTO student VALUES (1, 'Aditi'), (2, 'Vaibhavi'), (3, 'Anushka'); 
DMSL 12 MapReduce 
Create database: test> use mystudents switched to db mystudents 
Create collection: mystudents> db.createCollection("student_info") 
{ ok: 1 } 
mystudents> db.student_info.insertOne({ 
... name:"Vaibhavi", 
... roll_no:27, 
... Year:"Second", 
... sports:"Badminton", 
... marks:65}) { acknowledged: true, insertedId: ObjectId("63710ac823940cd204dbd0ac") 
} mystudents> db.student_info.insertOne({ 
... name:"Anushka", 
... roll_no:01, 
... Year:"Third", 
... sports:"Hockey", 
... marks:80}) 
{ acknowledged: true, insertedId: ObjectId("63710ad223940cd204dbd0ad") 
} 
mystudents> db.student_info.insertOne({ 
... name:"Aditi", 
... roll_no:42, 
... Year:"Third", 
... sports:"Cricket", 
... marks:70}) { acknowledged: true, insertedId: ObjectId("63710ada23940cd204dbd0ae") 
} 
mystudents> db.student_info.insertOne({ 
... name:"Mohana", 
... roll_no:37, 
... Year:"Second", 
... sports:"Football", 
... marks:97}) { acknowledged: true, insertedId: ObjectId("63710ae223940cd204dbd0af") 
} 
MapReduce function: 
mystudents> var map=function(){emit(this.Year,this.marks);}; 
mystudents> var reduce=function(Year,marks){return Array.sum(marks);}; 
mystudents> db.student_info.mapReduce(map,reduce,{out:"result"}); 
{ result: 'result', ok: 1 } 
mystudents> db.result.find() 
[ 
{ _id: 'Second', value: 227 }, 
{ _id: 'Third', value: 150 } 
] 
